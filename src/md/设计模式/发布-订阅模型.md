---
title: 发布-订阅模型面试题
category: 设计模式
tags: [设计模式, 发布-订阅模型, 状态管理]
description: 发布-订阅模型的面试题，包括核心概念、工作流程和使用方法
date: 2026-02-09
---

---

## 一、直觉版理解（先有画面）

👉 **报社订阅报纸**

* 发布者（Publisher）：报社
* 订阅者（Subscriber）：读者
* 事件 / 消息（Event / Message）：报纸内容
* 中间人（Broker / Event Bus）：邮局

报社**不关心**谁在看
读者**不关心**报社怎么印
邮局负责把报纸发给所有订阅的人

👉 **核心思想：双方互相不知道对方存在**

---

## 二、模型结构（标准定义）

发布-订阅模型由 3 个角色组成：

```
Publisher  →  Event Bus / Broker  →  Subscribers
```

### 1️⃣ 发布者（Publisher）

* 只负责 **发布消息**
* 不关心：

  * 谁会接收
  * 有多少接收者
  * 接收者是否在线

### 2️⃣ 订阅者（Subscriber）

* 只关心：

  * **我订阅了什么类型的消息**
* 不直接和发布者通信

### 3️⃣ 事件中心 / 消息中介（Broker）

* 负责：

  * 事件管理
  * 消息分发
  * 订阅关系维护

---

## 三、和“观察者模式”的关键区别（面试高频）

| 对比点        | 发布-订阅      | 观察者   |
| ---------- | ---------- | ----- |
| 是否有中间层     | ✅ 有 Broker | ❌ 无   |
| 发布者是否知道订阅者 | ❌ 不知道      | ✅ 知道  |
| 耦合度        | **极低**     | 中等    |
| 分布式支持      | 非常好        | 较差    |
| 典型场景       | 消息队列、事件总线  | UI 组件 |

👉 **一句话区分**

> 有“中间人”的是发布-订阅，没有的是观察者。

---

## 四、一个最小实现（前端版）

### 1️⃣ 简易事件总线

```js
class EventBus {
  constructor() {
    this.events = {};
  }

  // 订阅
  on(event, callback) {
    if (!this.events[event]) {
      this.events[event] = [];
    }
    this.events[event].push(callback);
  }

  // 发布
  emit(event, data) {
    const listeners = this.events[event];
    if (listeners) {
      listeners.forEach(fn => fn(data));
    }
  }

  // 取消订阅
  off(event, callback) {
    this.events[event] =
      (this.events[event] || []).filter(fn => fn !== callback);
  }
}
```

### 2️⃣ 使用

```js
const bus = new EventBus();

bus.on('login', user => {
  console.log('用户登录：', user);
});

bus.emit('login', { id: 1, name: '张三' });
```

👉 **发布者和订阅者完全无感知**

---

## 五、在真实系统里的应用

### ✅ 前端

* Vue / React 事件通信
* 全局状态变化通知
* WebSocket 消息分发

### ✅ 后端

* Kafka / RabbitMQ / Redis PubSub
* 订单 → 库存 → 积分 → 通知（典型解耦链路）
* 微服务事件驱动架构

### ✅ 跨端 / 系统

* 埋点系统
* 日志系统
* 实时通知

---

## 六、为什么它这么重要？

### 🟢 优点

* **强解耦**
* 易扩展（加订阅者不影响发布者）
* 天然支持广播
* 非常适合分布式系统

### 🔴 缺点

* 调试困难（事件链路不直观）
* 顺序 & 一致性需要额外设计
* 滥用会变成“事件地狱”

---

## 七、常见设计陷阱（高级经验）

❌ 事件名随便起

> 建议：`业务域:动作`

```text
order:created
user:login
payment:success
```

❌ 一个事件干太多事

> 事件应该**语义单一**

❌ 不可追踪

> 生产系统必须：

* traceId
* 日志埋点
* 失败重试策略

---

## 八、一句面试级总结

> 发布-订阅模型通过**事件中介**实现发布者与订阅者的**完全解耦**，是构建**事件驱动、分布式系统**的基础通信模式。



